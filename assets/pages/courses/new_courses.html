<div class="modal-header">
  <h5 class="modal-title">Add a new course</h5>
  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">    

  <form method="post" class="pop-form" enctype="application/x-www-form-urlencoded">
    <div class="row">
      <div class="col-md-12 mb-3">
        <input type="text" id="coursesName" class="form-control" placeholder="Name of the Course">
      </div>
      <div class="col-md-12 mb-3">
        <input type="text" id="coursesID" class="form-control" placeholder="Course ID Prefix">
      </div>
      <div class="col-md-12 mb-3 selectParent">
        <div class="dropdown-select">
          <select class="sort-select" id="category">
            <option value="">Select Category</option>
          </select>
        </div>
      </div>
      <div class="col-md-12 mb-3 selectParent">
       <div class="dropdown-select">
          <select class="sort-select" id="subCategory">
            <option value="">Select Sub Category</option>
          </select>
        </div>
      </div>
      <div class="col-md-12 mb-3">
        <input type="file" id="courseFile" class="form-control" placeholder="import a file">
      </div>
    </div>
    <div class="row">
      <div class="col-md-6 mb-3">
        <input type="date" id="" name="" class="form-control" placeholder="Start Date">
      </div>
      <div class="col-md-6 mb-3">
        <input type="date" id="" name="" class="form-control" placeholder="End Date">
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 mb-3 selectParent">
       <div class="dropdown-select">
          <select class="sort-select" id="member">
            <option value="">Select Member</option>
          </select>
        </div>
      </div>
      <div class="col-md-12 mb-3">
        <input type="text" id="tags" class="form-control" placeholder="Tag">
      </div>
      <div class="col-md-12 mb-3">
        <input type="text" id="desc" class="form-control" placeholder="One line description">
      </div>
    </div>
  </form>

</div>
<div class="modal-footer">
  <span class="orange-btn nbtn">
    <button type="button" class="btn btn-primary" id="saveCourses">Save</button>
  </span>
</div>
<script type="text/javascript">
var subCategory = {};
$( document ).ready(function() {
  //load the category data
  $.ajax({
    url: API_BASE_URL + '/category/',
    type: 'get',
    dataType: 'json',
    success:function(response){
      $("#category").empty();
      $("#category").append("<option value=''>Select Category</option>");
      $.each( response, function( i, val ) {
        $("#category").append("<option value='"+val.id+"'>"+val.name+"</option>");
      });
    }
  });

  $.ajax({
    url: API_BASE_URL + '/sub_category/',
    type: 'get',
    dataType: 'json',
    success:function(response){
      $.each( response, function( i, val ) {
        if(typeof (subCategory[val.category_id]) === "undefined") {
          subCategory[val.category_id] = [];
        }
        subCategory[val.category_id].push(val);
      });
    }
  });

  $.ajax({
    url: API_BASE_URL + '/members/',
    type: 'get',
    dataType: 'json',
    success:function(response){
      $("#member").empty();
      $("#member").append("<option value=''>Select Member</option>");
      $.each( response, function( i, val ) {
        $("#member").append("<option value='"+val.id+"'>"+val.first_name+" " + val.last_name+"</option>");
      });
    }
  });
  
  $("#category").on("change", function() {
    $("#subCategory").empty();
    if($(this).val()) {
      var resp = subCategory[$(this).val()];
      $("#subCategory").append("<option value=''>Select Sub Category</option>");
      if(typeof(resp) === "undefined") {
        console.log("subcategory not found: " + $(this).find("option:selected").text() );
      } else {
        $.each( resp, function( i, val ) {
          $("#subCategory").append("<option value='"+val.id+"'>"+val.name+"</option>");
        });
      }
    }
  });
  
  
  /*LATER USE*/
  /* ============================================================ */
  /*
  $("#category").on("change", function() {
    $("#subCategory").empty();
    if($(this).val()) {
      console.log("Changes request :"  + $(this).val());
      $.ajax({
        url: API_BASE_URL + '/subcategory/',
        type: 'get',
        dataType: 'json',
        success:function(response){
          $("#subCategory").empty();
          $("#subCategory").append("<option value=''>Select Sub Category</option>");
          $.each( response, function( i, val ) {
            $("#subCategory").append("<option value='"+val.id+"'>"+val.name+"</option>");
          });
        }
      });
    }
  });
  */
  /* ============================================================ */
  //subCategory
  
  $("#saveCourses").on("click", function() {
    alert("save");
  });
});

</script>